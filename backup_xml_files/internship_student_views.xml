<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>

        <!-- Enhanced Student Tree View -->
        <record id="view_internship_student_tree" model="ir.ui.view">
            <field name="name">internship.student.tree</field>
            <field name="model">internship.student</field>
            <field name="arch" type="xml">
                <tree string="Students"
                      create="true"
                      editable="false"
                      multi_edit="1"
                      decoration-info="state == 'active'"
                      decoration-warning="state == 'inactive'"
                      decoration-success="average_grade >= 15"
                      decoration-primary="stage_count > 0">
                    <!-- Personal Information -->
                    <field name="name"/>
                    <field name="email"/>
                    <field name="phone"/>
                    <field name="birth_date"/>

                    <!-- Academic Information -->
                    <field name="school"/>
                    <field name="study_level"/>
                    <field name="specialization"/>
                    <field name="student_number"/>
                    <field name="expected_graduation"/>

                    <!-- Internship Statistics -->
                    <field name="stage_count" string="Internships" widget="numeric"/>
                    <field name="average_grade" string="Avg. Grade" widget="numeric"/>
                    <field name="state" widget="badge"/>

                    <!-- Status and Dates -->
                    <field name="active" widget="boolean_toggle"/>
                    <field name="create_date"/>
                    <field name="write_date"/>
                </tree>
            </field>
        </record>

        <!-- Student Kanban View -->
        <record id="view_internship_student_kanban" model="ir.ui.view">
            <field name="name">internship.student.kanban</field>
            <field name="model">internship.student</field>
            <field name="arch" type="xml">
                <kanban class="o_kanban_mobile">
                    <field name="id"/>
                    <field name="name"/>
                    <field name="email"/>
                    <field name="phone"/>
                    <field name="school"/>
                    <field name="study_level"/>
                    <field name="specialization"/>
                    <field name="stage_count"/>
                    <field name="average_grade"/>
                    <field name="state"/>
                    <field name="image_1920"/>
                    <templates>
                        <t t-name="kanban-box">
                            <div class="oe_kanban_global_click o_kanban_record_has_image_fill">
                                <div class="o_kanban_image_fill_left d-none d-md-block" t-attf-style="background-image:url('#{kanban_image('internship.student', 'image_1920', record.id.raw_value)}')">
                                </div>
                                <div class="oe_kanban_details">
                                    <div class="o_kanban_record_top">
                                        <div class="o_kanban_record_headings">
                                            <strong class="o_kanban_record_title">
                                                <field name="name"/>
                                            </strong>
                                        </div>
                                        <span class="badge badge-pill" t-attf-style="background-color: #{record.state.raw_value == 'active' ? '#28a745' : '#dc3545'};">
                                            <field name="state"/>
                                        </span>
                                    </div>
                                    <div class="o_kanban_record_body">
                                        <field name="email"/>
                                        <div class="text-muted">
                                            <i class="fa fa-phone"/> <field name="phone"/>
                                        </div>
                                        <div class="text-muted">
                                            <i class="fa fa-graduation-cap"/> <field name="school"/>
                                        </div>
                                        <div class="text-muted">
                                            <field name="study_level"/> - <field name="specialization"/>
                                        </div>
                                    </div>
                                    <div class="o_kanban_record_bottom">
                                        <div class="oe_kanban_bottom_left">
                                            <span class="badge badge-secondary">
                                                <field name="stage_count"/> internships
                                            </span>
                                        </div>
                                        <div class="oe_kanban_bottom_right" t-if="record.average_grade.raw_value > 0">
                                            <span class="badge badge-success">
                                                Avg: <field name="average_grade"/>
                                            </span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </t>
                    </templates>
                </kanban>
            </field>
        </record>

        <!-- Student Search View -->
        <record id="view_internship_student_search" model="ir.ui.view">
            <field name="name">internship.student.search</field>
            <field name="model">internship.student</field>
            <field name="arch" type="xml">
                <search string="Search Students">
                    <!-- Search Fields -->
                    <field name="name"/>
                    <field name="email"/>
                    <field name="student_number"/>
                    <field name="school"/>
                    <field name="specialization"/>

                    <!-- Filters -->
                    <filter string="Active Students" name="active_students"
                            domain="[('state', '=', 'active')]"/>
                    <filter string="Inactive Students" name="inactive_students"
                            domain="[('state', '=', 'inactive')]"/>
                    <filter string="With Internships" name="with_internships"
                            domain="[('stage_count', '>', 0)]"/>
                    <filter string="High Performers" name="high_performers"
                            domain="[('average_grade', '>=', 15)]"/>

                    <!-- Study Level Filters -->
                    <separator/>
                    <filter string="Bac+3" name="bac_3" domain="[('study_level', '=', 'bac+3')]"/>
                    <filter string="Bac+4" name="bac_4" domain="[('study_level', '=', 'bac+4')]"/>
                    <filter string="Bac+5" name="bac_5" domain="[('study_level', '=', 'bac+5')]"/>
                    <filter string="Master" name="master" domain="[('study_level', '=', 'master')]"/>
                    <filter string="PhD" name="phd" domain="[('study_level', '=', 'phd')]"/>

                    <!-- Group By -->
                    <group expand="0" string="Group By">
                       <filter string="State" name="group_state" context="{'group_by': 'state'}"/>
                       <filter string="School" name="group_school" context="{'group_by': 'school'}"/>
                       <filter string="Study Level" name="group_study_level" context="{'group_by': 'study_level'}"/>
                       <filter string="Specialization" name="group_specialization" context="{'group_by': 'specialization'}"/>
                       <filter string="Expected Graduation" name="group_graduation" context="{'group_by': 'expected_graduation:month'}"/>
                       <filter string="Country" name="group_country" context="{'group_by': 'country_id'}"/>
                   </group>
               </search>
           </field>
       </record>

       <!-- Student Form View -->
       <record id="view_internship_student_form" model="ir.ui.view">
           <field name="name">internship.student.form</field>
           <field name="model">internship.student</field>
           <field name="arch" type="xml">
               <form string="Student">
                   <header>
                       <button name="action_activate" string="Activate" type="object"
                               class="oe_highlight"
                               invisible="state == 'active'"/>
                       <button name="action_deactivate" string="Deactivate" type="object"
                               invisible="state == 'inactive'"/>
                       <field name="state" widget="statusbar" statusbar_visible="active,inactive"/>
                   </header>

                   <sheet>
                       <div class="oe_button_box" name="button_box">
                           <!-- Smart buttons -->
                           <button class="oe_stat_button" type="object" name="action_view_internships" icon="fa-briefcase">
                               <field string="Internships" name="stage_count" widget="statinfo"/>
                           </button>

                           <button class="oe_stat_button" type="object" name="action_view_documents" icon="fa-file-text">
                               <field string="Documents" name="document_count" widget="statinfo"/>
                           </button>

                           <button class="oe_stat_button" type="object" name="action_view_messages" icon="fa-envelope">
                               <field string="Messages" name="message_count" widget="statinfo"/>
                           </button>
                       </div>

                       <!-- Image and Name -->
                       <field name="image_1920" widget="image" class="oe_avatar" options="{'preview_image': 'image_256'}"/>

                       <div class="oe_title">
                           <label for="name"/>
                           <h1><field name="name" placeholder="Student full name..."/></h1>
                           <div class="o_row">
                               <field name="student_number" placeholder="Student ID"/>
                           </div>
                       </div>

                       <!-- Basic Information -->
                       <group>
                           <group name="personal_info" string="Personal Information">
                               <field name="email" widget="email"/>
                               <field name="phone" widget="phone"/>
                               <field name="mobile" widget="phone"/>
                               <field name="birth_date"/>
                               <field name="nationality"/>
                           </group>
                           <group name="contact_info" string="Address">
                               <field name="address"/>
                               <field name="city"/>
                               <field name="postal_code"/>
                               <field name="country_id"/>
                           </group>
                       </group>

                       <!-- Academic Information -->
                       <group>
                           <group name="academic_info" string="Academic Information">
                               <field name="school"/>
                               <field name="faculty"/>
                               <field name="department"/>
                               <field name="study_level"/>
                               <field name="specialization"/>
                               <field name="academic_year"/>
                               <field name="expected_graduation"/>
                           </group>
                           <group name="performance" string="Performance">
                               <field name="gpa"/>
                               <field name="average_grade" readonly="1"/>
                               <field name="ranking"/>
                           </group>
                       </group>

                       <!-- Additional Information -->
                       <notebook>
                           <page name="skills" string="Skills &amp; Competencies">
                               <group>
                                   <group name="technical_skills" string="Technical Skills">
                                       <field name="skill_ids" nolabel="1">
                                           <tree editable="bottom">
                                               <field name="skill_id"/>
                                               <field name="level"/>
                                               <field name="validated"/>
                                               <field name="validation_date"/>
                                           </tree>
                                       </field>
                                   </group>
                                   <group name="languages" string="Languages">
                                       <field name="language_ids" nolabel="1">
                                           <tree editable="bottom">
                                               <field name="language"/>
                                               <field name="level"/>
                                               <field name="certification"/>
                                           </tree>
                                       </field>
                                   </group>
                               </group>

                               <group name="interests" string="Areas of Interest">
                                   <field name="interest_area_ids" widget="many2many_tags" nolabel="1"/>
                               </group>
                           </page>

                           <page name="cv" string="CV &amp; Portfolio">
                               <group>
                                   <group name="links" string="Professional Links">
                                       <field name="linkedin_profile" widget="url"/>
                                       <field name="github_profile" widget="url"/>
                                       <field name="portfolio_url" widget="url"/>
                                   </group>
                                   <group name="documents" string="Documents">
                                       <field name="cv_uploaded"/>
                                       <field name="portfolio_uploaded"/>
                                       <field name="transcript_uploaded"/>
                                   </group>
                               </group>

                               <separator string="Bio &amp; Summary"/>
                               <field name="bio" nolabel="1" placeholder="Brief description about the student..."/>

                               <separator string="Career Objectives"/>
                               <field name="career_objectives" nolabel="1" placeholder="Student's career goals and objectives..."/>
                           </page>

                           <page name="internships" string="Internships">
                               <field name="stage_ids" nolabel="1">
                                   <tree>
                                       <field name="reference"/>
                                       <field name="name"/>
                                       <field name="stage_type"/>
                                       <field name="supervisor_id"/>
                                       <field name="start_date"/>
                                       <field name="end_date"/>
                                       <field name="state"/>
                                       <field name="grade"/>
                                   </tree>
                               </field>
                           </page>

                           <page name="evaluations" string="Evaluations">
                               <field name="evaluation_ids" nolabel="1">
                                   <tree>
                                       <field name="evaluation_date"/>
                                       <field name="evaluator_id"/>
                                       <field name="criteria"/>
                                       <field name="score"/>
                                       <field name="comments"/>
                                   </tree>
                               </field>
                           </page>

                           <page name="emergency" string="Emergency Contact">
                               <group>
                                   <group name="emergency_contact" string="Emergency Contact">
                                       <field name="emergency_contact_name"/>
                                       <field name="emergency_contact_relation"/>
                                       <field name="emergency_contact_phone"/>
                                       <field name="emergency_contact_email"/>
                                   </group>
                                   <group name="medical" string="Medical Information">
                                       <field name="medical_conditions"/>
                                       <field name="allergies"/>
                                       <field name="medications"/>
                                   </group>
                               </group>
                           </page>

                           <page name="notes" string="Notes">
                               <field name="notes" nolabel="1" placeholder="Additional notes about the student..."/>
                           </page>
                       </notebook>
                   </sheet>

                   <!-- Chatter -->
                   <div class="oe_chatter">
                       <field name="message_follower_ids"/>
                       <field name="activity_ids"/>
                       <field name="message_ids"/>
                   </div>
               </form>
           </field>
       </record>

       <!-- ================================= -->
       <!-- ACTIONS -->
       <!-- ================================= -->

       <!-- Main action for students -->
       <record id="action_internship_student_list" model="ir.actions.act_window">
           <field name="name">Students</field>
           <field name="res_model">internship.student</field>
           <field name="view_mode">kanban,tree,form</field>
           <field name="context">{'search_default_active_students': 1}</field>
           <field name="help" type="html">
               <p class="o_view_nocontent_smiling_face">
                   Add your first student!
               </p>
               <p>
                   Manage students who will participate in internships.
               </p>
           </field>
       </record>

       <!-- My Profile Action (for students) -->
       <record id="action_internship_student_my_profile" model="ir.actions.act_window">
           <field name="name">My Profile</field>
           <field name="res_model">internship.student</field>
           <field name="view_mode">form</field>
           <field name="domain">[('user_id', '=', uid)]</field>
           <field name="context">{'create': False}</field>
       </record>

   </data>
</odoo>
<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>
        <!-- Internship Agreement Report -->
        <template id="convention_report_document">
            <t t-call="web.html_container">
                <t t-foreach="docs" t-as="stage">
                    <t t-call="internship_management.convention_report_layout"/>
                </t>
            </t>
        </template>

        <template id="convention_report_layout">
            <div class="page" style="font-family: 'Segoe UI', Arial, sans-serif; color: #2c3e50;">

                <!-- Professional Header -->
                <div style="border-bottom: 3px solid #2980b9; padding-bottom: 20px; margin-bottom: 30px;">
                    <div class="row">
                        <div class="col-8">
                            <h1 style="margin: 0; font-weight: 300; font-size: 28px; color: #2c3e50;">
                                INTERNSHIP AGREEMENT
                            </h1>
                            <h2 style="margin: 5px 0 0 0; color: #2980b9; font-weight: 400; font-size: 16px;">
                                Professional Internship Contract - TechPal
                            </h2>
                        </div>
                        <div class="col-4 text-right">
                            <div style="color: #7f8c8d; font-size: 12px;">
                                <strong>Contract No:</strong> <span t-esc="data[stage.id]['reference']"/><br/>
                                <strong>Date:</strong> <span t-esc="data[stage.id]['current_date']"/><br/>
                                <strong>Valid until:</strong> <span t-esc="data[stage.id]['end_date']"/>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Agreement Parties -->
                <div style="background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
                           border-left: 4px solid #2980b9; padding: 20px; margin-bottom: 25px; border-radius: 5px;">
                    <h3 style="color: #2c3e50; margin-bottom: 15px; font-size: 18px;">
                        <i class="fa fa-users" style="color: #2980b9; margin-right: 8px;"></i>
                        Contracting Parties
                    </h3>

                    <!-- Company Information -->
                    <div style="margin-bottom: 20px;">
                        <h4 style="color: #34495e; font-size: 16px; margin-bottom: 10px;">Company:</h4>
                        <table style="width: 100%; font-size: 13px;">
                            <tr style="height: 25px;">
                                <td style="font-weight: bold; color: #34495e; width: 25%;">Company Name:</td>
                                <td t-esc="data[stage.id]['company_name']"/>
                            </tr>
                            <tr style="height: 25px;">
                                <td style="font-weight: bold; color: #34495e;">Address:</td>
                                <td>Casablanca, Morocco</td>
                            </tr>
                            <tr style="height: 25px;">
                                <td style="font-weight: bold; color: #34495e;">Supervisor:</td>
                                <td><span t-esc="data[stage.id]['supervisor_name']"/> - <span t-esc="data[stage.id]['supervisor_position']"/></td>
                            </tr>
                        </table>
                    </div>

                    <!-- Student Information -->
                    <div>
                        <h4 style="color: #34495e; font-size: 16px; margin-bottom: 10px;">Intern:</h4>
                        <table style="width: 100%; font-size: 13px;">
                            <tr style="height: 25px;">
                                <td style="font-weight: bold; color: #34495e; width: 25%;">Full Name:</td>
                                <td t-esc="data[stage.id]['student_name']"/>
                            </tr>
                            <tr style="height: 25px;">
                                <td style="font-weight: bold; color: #34495e;">Student ID:</td>
                                <td t-esc="data[stage.id]['student_id_number']"/>
                            </tr>
                            <tr style="height: 25px;">
                                <td style="font-weight: bold; color: #34495e;">Institution:</td>
                                <td t-esc="data[stage.id]['institution']"/>
                            </tr>
                            <tr style="height: 25px;">
                                <td style="font-weight: bold; color: #34495e;">Email:</td>
                                <td t-esc="data[stage.id]['student_email']"/>
                            </tr>
                            <tr style="height: 25px;">
                                <td style="font-weight: bold; color: #34495e;">Phone:</td>
                                <td t-esc="data[stage.id]['student_phone']"/>
                            </tr>
                        </table>
                    </div>
                </div>

                <!-- Internship Details -->
                <div style="background: #ffffff; border: 1px solid #e9ecef; border-radius: 5px;
                           padding: 20px; margin-bottom: 25px; box-shadow: 0 1px 3px rgba(0,0,0,0.1);">
                    <h3 style="color: #2c3e50; margin-bottom: 15px; font-size: 18px;">
                        <i class="fa fa-briefcase" style="color: #27ae60; margin-right: 8px;"></i>
                        Internship Details
                    </h3>
                    <table style="width: 100%; font-size: 13px;">
                        <tr style="height: 30px;">
                            <td style="font-weight: bold; color: #34495e; width: 25%;">Project Title:</td>
                            <td t-esc="data[stage.id]['internship_title']"/>
                        </tr>
                        <tr style="height: 30px;">
                            <td style="font-weight: bold; color: #34495e;">Start Date:</td>
                            <td t-esc="data[stage.id]['start_date']"/>
                        </tr>
                        <tr style="height: 30px;">
                            <td style="font-weight: bold; color: #34495e;">End Date:</td>
                            <td t-esc="data[stage.id]['end_date']"/>
                        </tr>
                        <tr style="height: 30px;">
                            <td style="font-weight: bold; color: #34495e;">Duration:</td>
                            <td t-esc="data[stage.id]['duration_weeks']"/>
                        </tr>
                        <tr style="height: 30px;">
                            <td style="font-weight: bold; color: #34495e;">Work Schedule:</td>
                            <td>Monday to Friday, 8:30 AM - 5:30 PM</td>
                        </tr>
                    </table>
                </div>

                <!-- Objectives -->
                <div style="background: linear-gradient(135deg, #fff3cd 0%, #fef9e7 100%);
                           border-left: 4px solid #f39c12; padding: 20px; margin-bottom: 25px; border-radius: 5px;">
                    <h3 style="color: #2c3e50; margin-bottom: 15px; font-size: 18px;">
                        <i class="fa fa-target" style="color: #f39c12; margin-right: 8px;"></i>
                        Learning Objectives
                    </h3>
                    <p style="margin: 0; line-height: 1.6; font-size: 14px;" t-esc="data[stage.id]['objectives']"/>
                </div>

                <!-- Terms and Conditions -->
                <div style="background: #f8f9fa; border: 1px solid #dee2e6; border-radius: 5px;
                           padding: 20px; margin-bottom: 25px;">
                    <h3 style="color: #2c3e50; margin-bottom: 15px; font-size: 18px;">
                        <i class="fa fa-gavel" style="color: #8e44ad; margin-right: 8px;"></i>
                        Terms and Conditions
                    </h3>
                    <ol style="margin: 0; padding-left: 20px; line-height: 1.8; font-size: 13px;">
                        <li>The intern commits to respecting company policies and procedures.</li>
                        <li>Confidentiality must be maintained regarding company information.</li>
                        <li>Regular attendance and punctuality are required.</li>
                        <li>The intern will be evaluated based on performance and learning objectives.</li>
                        <li>Any absence must be justified and approved by the supervisor.</li>
                        <li>The company provides necessary equipment and guidance for the internship.</li>
                        <li>This agreement can be terminated by either party with 48 hours notice.</li>
                    </ol>
                </div>

                <!-- Signatures -->
                <div style="margin-top: 40px;">
                    <h3 style="color: #2c3e50; margin-bottom: 20px; font-size: 18px;">
                        <i class="fa fa-pencil" style="color: #34495e; margin-right: 8px;"></i>
                        Signatures and Approval
                    </h3>
                    <div class="row">
                        <div class="col-4 text-center">
                            <div style="border-top: 1px solid #34495e; padding-top: 10px; margin-top: 60px;">
                                <strong>Company Supervisor</strong><br/>
                                <span t-esc="data[stage.id]['supervisor_name']"/><br/>
                                <small style="color: #7f8c8d;">Date &amp; Signature</small>
                            </div>
                        </div>
                        <div class="col-4 text-center">
                            <div style="border-top: 1px solid #34495e; padding-top: 10px; margin-top: 60px;">
                                <strong>Intern</strong><br/>
                                <span t-esc="data[stage.id]['student_name']"/><br/>
                                <small style="color: #7f8c8d;">Date &amp; Signature</small>
                            </div>
                        </div>
                        <div class="col-4 text-center">
                            <div style="border-top: 1px solid #34495e; padding-top: 10px; margin-top: 60px;">
                                <strong>HR Director</strong><br/>
                                TechPal Management<br/>
                                <small style="color: #7f8c8d;">Date &amp; Signature</small>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Footer -->
                <div style="margin-top: 40px; border-top: 1px solid #e9ecef; padding-top: 15px;
                           text-align: center; color: #7f8c8d; font-size: 11px;">
                    TechPal Internship Management System - Professional Agreement Document<br/>
                    This is a legally binding document. Please read all terms carefully before signing.
                </div>
            </div>
        </template>

        <!-- Internship Certificate -->
        <template id="attestation_report_document">
            <t t-call="web.html_container">
                <t t-foreach="docs" t-as="stage">
                    <t t-call="internship_management.attestation_report_layout"/>
                </t>
            </t>
        </template>

        <template id="attestation_report_layout">
            <div class="page" style="font-family: 'Segoe UI', Arial, sans-serif; color: #2c3e50;">

                <!-- Professional Header -->
                <div style="border-bottom: 3px solid #27ae60; padding-bottom: 20px; margin-bottom: 30px;">
                    <div class="row">
                        <div class="col-8">
                            <h1 style="margin: 0; font-weight: 300; font-size: 28px; color: #2c3e50;">
                                INTERNSHIP CERTIFICATE
                            </h1>
                            <h2 style="margin: 5px 0 0 0; color: #27ae60; font-weight: 400; font-size: 16px;">
                                Official Completion Certificate - TechPal
                            </h2>
                        </div>
                        <div class="col-4 text-right">
                            <div style="color: #7f8c8d; font-size: 12px;">
                                <strong>Certificate No:</strong> <span t-esc="data[stage.id]['reference']"/><br/>
                                <strong>Issue Date:</strong> <span t-esc="data[stage.id]['current_date']"/><br/>
                                <strong>Authority:</strong> TechPal HR Department
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Certificate Body -->
                <div style="text-align: center; margin: 50px 0;">
                    <div style="background: linear-gradient(135deg, #e8f5e8 0%, #f0f8f0 100%);
                               border: 2px solid #27ae60; border-radius: 10px; padding: 40px; margin: 30px 0;">
                        <h3 style="color: #2c3e50; font-size: 20px; margin-bottom: 20px;">
                            This is to certify that
                        </h3>
                        <h2 style="color: #27ae60; font-size: 32px; margin: 20px 0; font-weight: bold;">
                            <span t-esc="data[stage.id]['student_name']"/>
                        </h2>
                        <h4 style="color: #34495e; font-size: 16px; margin: 20px 0;">
                            Student ID: <span t-esc="data[stage.id]['student_id_number']"/>
                        </h4>
                        <p style="color: #2c3e50; font-size: 16px; line-height: 1.8; margin: 30px 0;">
                            has successfully completed an internship at <strong t-esc="data[stage.id]['company_name']"/>
                            from <strong t-esc="data[stage.id]['start_date']"/> to <strong t-esc="data[stage.id]['end_date']"/>
                            (<strong t-esc="data[stage.id]['duration_days']"/> days).
                        </p>
                        <p style="color: #2c3e50; font-size: 16px; line-height: 1.8; margin: 20px 0;">
                            Project Title: <strong>"<span t-esc="data[stage.id]['internship_title']"/>"</strong>
                        </p>
                        <div style="margin: 30px 0;">
                            <span style="background: #27ae60; color: white; padding: 10px 20px; border-radius: 25px; font-size: 18px; font-weight: bold;">
                                Final Grade: <span t-esc="data[stage.id]['final_grade']"/>/20
                            </span>
                        </div>
                        <p style="color: #2c3e50; font-size: 14px; margin: 20px 0;">
                            Performance Level: <strong t-esc="data[stage.id]['performance']"/>
                        </p>
                    </div>
                </div>

                <!-- Supervisor Information -->
                <div style="background: #f8f9fa; border: 1px solid #dee2e6; border-radius: 5px;
                           padding: 20px; margin-bottom: 30px; text-center;">
                    <h4 style="color: #2c3e50; margin-bottom: 15px;">Under the supervision of</h4>
                    <p style="color: #34495e; font-size: 16px; margin: 10px 0;">
                        <strong t-esc="data[stage.id]['supervisor_name']"/>
                    </p>
                    <p style="color: #7f8c8d; font-size: 14px; margin: 5px 0;">
                        <span t-esc="data[stage.id]['company_name']"/>
                    </p>
                </div>

                <!-- Official Seal Area -->
                <div style="margin-top: 60px;">
                    <div class="row">
                        <div class="col-6">
                            <div style="text-align: center;">
                                <div style="border: 2px solid #34495e; border-radius: 50%; width: 120px; height: 120px;
                                           margin: 0 auto 20px auto; display: flex; align-items: center; justify-content: center;">
                                    <div style="text-align: center; color: #34495e; font-size: 12px;">
                                        <strong>OFFICIAL SEAL</strong><br/>
                                        TechPal<br/>
                                        HR Department
                                    </div>
                                </div>
                                <p style="color: #7f8c8d; font-size: 12px;">Company Seal</p>
                            </div>
                        </div>
                        <div class="col-6">
                            <div style="text-align: center; margin-top: 40px;">
                                <div style="border-top: 1px solid #34495e; padding-top: 10px; margin-top: 40px; width: 200px; margin-left: auto; margin-right: auto;">
                                    <strong>HR Director</strong><br/>
                                    TechPal Management<br/>
                                    <small style="color: #7f8c8d;">Authorized Signature</small>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Footer -->
                <div style="margin-top: 50px; border-top: 1px solid #e9ecef; padding-top: 15px;
                           text-align: center; color: #7f8c8d; font-size: 11px;">
                    This certificate is issued by TechPal Internship Management System<br/>
                    Verification Code: <span t-esc="data[stage.id]['reference']"/> - Valid and Authentic Document
                </div>
            </div>
        </template>
    </data>
</odoo>
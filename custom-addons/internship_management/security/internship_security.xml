<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data noupdate="0">

        <!-- Security Categories -->
        <record id="module_category_internship" model="ir.module.category">
            <field name="name">Internship Management</field>
            <field name="description">Complete internship and student management system</field>
            <field name="sequence">10</field>
        </record>

        <!-- =============================================== -->
        <!-- SECURITY GROUPS -->
        <!-- =============================================== -->

        <!-- Group: Student/Intern -->
        <record id="group_internship_student" model="res.groups">
            <field name="name">Student/Intern</field>
            <field name="category_id" ref="module_category_internship"/>
            <field name="comment">Read/write access to own internships and documents</field>
        </record>

        <!-- Group: Supervisor -->
        <record id="group_internship_supervisor" model="res.groups">
            <field name="name">Supervisor</field>
            <field name="category_id" ref="module_category_internship"/>
            <field name="comment">Manage assigned students and validate internships</field>
        </record>

        <!-- Group: Internship Coordinator -->
        <record id="group_internship_coordinator" model="res.groups">
            <field name="name">Internship Coordinator</field>
            <field name="category_id" ref="module_category_internship"/>
            <field name="implied_ids" eval="[(4, ref('group_internship_supervisor'))]"/>
            <field name="comment">General coordination of internships and assignments</field>
        </record>

        <!-- Group: System Administrator -->
        <record id="group_internship_admin" model="res.groups">
            <field name="name">System Administrator</field>
            <field name="category_id" ref="module_category_internship"/>
            <field name="implied_ids" eval="[(4, ref('group_internship_coordinator'))]"/>
            <field name="comment">Full access to all internship management modules</field>
        </record>

        <!-- =============================================== -->
        <!-- RECORD RULES (SECURITY POLICIES) -->
        <!-- =============================================== -->

        <!-- Rule: Students - View only own data -->
        <record id="internship_student_rule_own" model="ir.rule">
            <field name="name">Students: Own data only</field>
            <field name="model_id" ref="model_internship_student"/>
            <field name="domain_force">[('user_id', '=', user.id)]</field>
            <field name="groups" eval="[(4, ref('group_internship_student'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="True"/>
            <field name="perm_create" eval="False"/>
            <field name="perm_unlink" eval="False"/>
        </record>

        <!-- Rule: Internships - Students see only their internships -->
        <record id="internship_stage_rule_student" model="ir.rule">
            <field name="name">Internships: Student sees own internships</field>
            <field name="model_id" ref="model_internship_stage"/>
            <field name="domain_force">[('student_id.user_id', '=', user.id)]</field>
            <field name="groups" eval="[(4, ref('group_internship_student'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="True"/>
            <field name="perm_create" eval="False"/>
            <field name="perm_unlink" eval="False"/>
        </record>

        <!-- Rule: Internships - Supervisors see assigned internships -->
        <record id="internship_stage_rule_supervisor" model="ir.rule">
            <field name="name">Internships: Supervisor sees assigned internships</field>
            <field name="model_id" ref="model_internship_stage"/>
            <field name="domain_force">[('supervisor_id.user_id', '=', user.id)]</field>
            <field name="groups" eval="[(4, ref('group_internship_supervisor'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="True"/>
            <field name="perm_create" eval="True"/>
            <field name="perm_unlink" eval="False"/>
        </record>

        <!-- Rule: Documents - Students see their own documents -->
        <record id="internship_document_rule_student" model="ir.rule">
            <field name="name">Documents: Student sees own documents</field>
            <field name="model_id" ref="model_internship_document"/>
            <field name="domain_force">['|', ('student_id.user_id', '=', user.id), ('stage_id.student_id.user_id', '=', user.id)]</field>
            <field name="groups" eval="[(4, ref('group_internship_student'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="True"/>
            <field name="perm_create" eval="True"/>
            <field name="perm_unlink" eval="True"/>
        </record>

        
        <!-- Rule: Documents - Supervisors see documents of their assigned students -->
        <record id="internship_document_rule_supervisor" model="ir.rule">
            <field name="name">Documents: Supervisor sees assigned students' documents</field>
            <field name="model_id" ref="model_internship_document"/>
            <field name="domain_force">[('supervisor_id.user_id', '=', user.id)]</field>
            <field name="groups" eval="[(4, ref('group_internship_supervisor'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="True"/>
            <field name="perm_create" eval="True"/>
            <field name="perm_unlink" eval="False"/>
        </record>

                <!-- Rule: Meetings - Students see meetings they participate in -->
        <record id="internship_meeting_rule_student" model="ir.rule">
            <field name="name">Meetings: Student sees participated meetings</field>
            <field name="model_id" ref="model_internship_meeting"/>
            <field name="domain_force">['|', 
                ('organizer_id', '=', user.id), 
                ('participant_ids', 'in', user.id)]</field>
            <field name="groups" eval="[(4, ref('group_internship_student'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="False"/>
            <field name="perm_create" eval="False"/>
            <field name="perm_unlink" eval="False"/>
        </record>

        <!-- Rule: Meetings - Supervisors see meetings they organize or participate in -->
        <record id="internship_meeting_rule_supervisor" model="ir.rule">
            <field name="name">Meetings: Supervisor sees organized and participated meetings</field>
            <field name="model_id" ref="model_internship_meeting"/>
            <field name="domain_force">['|', 
                ('organizer_id', '=', user.id), 
                ('participant_ids', 'in', user.id)]</field>
            <field name="groups" eval="[(4, ref('group_internship_supervisor'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="True"/>
            <field name="perm_create" eval="True"/>
            <field name="perm_unlink" eval="False"/>
        </record>

        <!-- Rule: Messages - Users see messages they send or receive -->
        <record id="internship_message_rule_user" model="ir.rule">
            <field name="name">Messages: User sees sent/received messages</field>
            <field name="model_id" ref="model_internship_message"/>
            <field name="domain_force">['|', ('sender_id', '=', user.id), ('recipient_ids', 'in', [user.id])]</field>
            <field name="groups" eval="[(4, ref('group_internship_student'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="False"/>
            <field name="perm_create" eval="True"/>
            <field name="perm_unlink" eval="False"/>
        </record>

        <!-- Rule: Messages - Supervisors see messages they send or receive -->
        <record id="internship_message_rule_supervisor" model="ir.rule">
            <field name="name">Messages: Supervisor sees sent/received messages</field>
            <field name="model_id" ref="model_internship_message"/>
            <field name="domain_force">['|', ('sender_id', '=', user.id), ('recipient_ids', 'in', [user.id])]</field>
            <field name="groups" eval="[(4, ref('group_internship_supervisor'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="True"/>
            <field name="perm_create" eval="True"/>
            <field name="perm_unlink" eval="False"/>
        </record>

        <!-- Rule: Notifications - Users see their own notifications -->
        <record id="internship_notification_rule_user" model="ir.rule">
            <field name="name">Notifications: User sees own notifications</field>
            <field name="model_id" ref="model_internship_notification"/>
            <field name="domain_force">[('user_id', '=', user.id)]</field>
            <field name="groups" eval="[(4, ref('group_internship_student'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="True"/>
            <field name="perm_create" eval="False"/>
            <field name="perm_unlink" eval="False"/>
        </record>
        <!-- Rule: Supervisors - Full access to own data -->
        <record id="internship_supervisor_rule_own" model="ir.rule">
            <field name="name">Supervisors: Own profile access</field>
            <field name="model_id" ref="model_internship_supervisor"/>
            <field name="domain_force">[('user_id', '=', user.id)]</field>
            <field name="groups" eval="[(4, ref('group_internship_supervisor'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="True"/>
            <field name="perm_create" eval="False"/>
            <field name="perm_unlink" eval="False"/>
        </record>

        <!-- Rule: Coordinators and Admins - Full access -->
        <record id="internship_all_rule_coordinator" model="ir.rule">
            <field name="name">Coordinator: Full access to internships</field>
            <field name="model_id" ref="model_internship_stage"/>
            <field name="domain_force">[(1, '=', 1)]</field>
            <field name="groups" eval="[(4, ref('group_internship_coordinator'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="True"/>
            <field name="perm_create" eval="True"/>
            <field name="perm_unlink" eval="True"/>
        </record>

        <record id="internship_student_rule_coordinator" model="ir.rule">
            <field name="name">Coordinator: All students access</field>
            <field name="model_id" ref="model_internship_student"/>
            <field name="domain_force">[(1, '=', 1)]</field>
            <field name="groups" eval="[(4, ref('group_internship_coordinator'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="True"/>
            <field name="perm_create" eval="True"/>
            <field name="perm_unlink" eval="True"/>
        </record>

        <record id="internship_supervisor_rule_coordinator" model="ir.rule">
            <field name="name">Coordinator: All supervisors access</field>
            <field name="model_id" ref="model_internship_supervisor"/>
            <field name="domain_force">[(1, '=', 1)]</field>
            <field name="groups" eval="[(4, ref('group_internship_coordinator'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="True"/>
            <field name="perm_create" eval="True"/>
            <field name="perm_unlink" eval="True"/>
        </record>

        <!-- Rule: Documents - Coordinators and Admins have full access -->
        <record id="internship_document_rule_coordinator" model="ir.rule">
            <field name="name">Coordinator: All documents access</field>
            <field name="model_id" ref="model_internship_document"/>
            <field name="domain_force">[(1, '=', 1)]</field>
            <field name="groups" eval="[(4, ref('group_internship_coordinator'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="True"/>
            <field name="perm_create" eval="True"/>
            <field name="perm_unlink" eval="True"/>
        </record>

        <!-- Rule: Messages - Coordinators see all messages -->
        <record id="internship_message_rule_coordinator" model="ir.rule">
            <field name="name">Coordinator: All messages access</field>
            <field name="model_id" ref="model_internship_message"/>
            <field name="domain_force">[(1, '=', 1)]</field>
            <field name="groups" eval="[(4, ref('group_internship_coordinator'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="True"/>
            <field name="perm_create" eval="True"/>
            <field name="perm_unlink" eval="True"/>
        </record>

        <!-- Rule: Notifications - Coordinators see all notifications -->
        <record id="internship_notification_rule_coordinator" model="ir.rule">
            <field name="name">Coordinator: All notifications access</field>
            <field name="model_id" ref="model_internship_notification"/>
            <field name="domain_force">[(1, '=', 1)]</field>
            <field name="groups" eval="[(4, ref('group_internship_coordinator'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="True"/>
            <field name="perm_create" eval="True"/>
            <field name="perm_unlink" eval="True"/>
        </record>

        <!-- Rule: Meetings - Coordinators see all meetings -->
        <record id="internship_meeting_rule_coordinator" model="ir.rule">
            <field name="name">Coordinator: All meetings access</field>
            <field name="model_id" ref="model_internship_meeting"/>
            <field name="domain_force">[(1, '=', 1)]</field>
            <field name="groups" eval="[(4, ref('group_internship_coordinator'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="True"/>
            <field name="perm_create" eval="True"/>
            <field name="perm_unlink" eval="True"/>
        </record>
       
        <!-- Rule: User Profiles - Users see their own profile -->
        <record id="internship_user_profile_rule_own" model="ir.rule">
            <field name="name">User Profiles: Own profile only</field>
            <field name="model_id" ref="model_internship_user_profile"/>
            <field name="domain_force">[('user_id', '=', user.id)]</field>
            <field name="groups" eval="[(4, ref('group_internship_student'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="True"/>
            <field name="perm_create" eval="False"/>
            <field name="perm_unlink" eval="False"/>
        </record>

        <!-- Rule: User Profiles - Coordinators see all profiles -->
        <record id="internship_user_profile_rule_coordinator" model="ir.rule">
            <field name="name">User Profiles: Coordinator full access</field>
            <field name="model_id" ref="model_internship_user_profile"/>
            <field name="domain_force">[(1, '=', 1)]</field>
            <field name="groups" eval="[(4, ref('group_internship_coordinator'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="True"/>
            <field name="perm_create" eval="True"/>
            <field name="perm_unlink" eval="True"/>
        </record>

    </data>
</odoo>



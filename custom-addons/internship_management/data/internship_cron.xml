<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data noupdate="1">

        <!--
        ======================================================================
        CRON JOB UNIQUE POUR LA DÉTECTION D'ALERTES ET LE SUIVI DES STAGES
        ======================================================================
        NOTE D'OPTIMISATION :
        Un seul cron job est utilisé pour centraliser toutes les tâches de
        vérification périodique. Ce cron appelle une méthode principale sur
        le modèle 'internship.stage', qui se charge ensuite d'appeler les
        méthodes de détection spécifiques sur les autres modèles (tâches, etc.).
        C'est plus propre et plus facile à maintenir que d'avoir plusieurs crons.
        Les crons pointant vers 'internship.alert' et les crons séparés
        ont été fusionnés dans celui-ci.
        -->
        <record id="ir_cron_internship_monitoring" model="ir.cron">
            <field name="name">Gestion des Stages : Suivi et Détection d'Anomalies</field>
            <!-- Le cron est rattaché au modèle principal 'internship.stage' -->
            <field name="model_id" ref="model_internship_stage"/>
            <field name="state">code</field>
            <!-- Cette méthode centrale appellera toutes les autres vérifications -->
            <field name="code">model._cron_internship_monitoring()</field>

            <!-- S'exécute tous les jours -->
            <field name="interval_number">1</field>
            <field name="interval_type">days</field>

            <!-- Ne s'arrête jamais -->
            <field name="numbercall">-1</field>

            <!-- Ne pas relancer en cas d'erreur pour éviter les boucles -->
            <field name="doall" eval="False"/>
            <field name="active" eval="True"/>
        </record>

    </data>
</odoo>